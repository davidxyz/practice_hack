"use strict";function e(e,n){function t(e,n){for(var t=new Array(80),i=-1,r=0,o=e.length,a=0;64>a;a++){var s=0;o>a?s=e.charCodeAt(a):n&&(a==o?s=n>>>24&255:a==o+1?s=n>>>16&255:a==o+2?s=n>>>8&255:a==o+3?s=255&n:a==o+4&&(s=128)),0===r&&(i++,t[i]=0,r=32),r-=8,t[i]=t[i]|s<<r}return n&&(t[15]=8*(64+o+4)),t}function i(e,n){for(var t=n<<24|n<<16|n<<8|n,i=0;16>i;i++)e[i]^=t;for(var r=[1732584193,4023233417,2562383102,271733878,3285377520],o=r[0],a=r[1],s=r[2],u=r[3],f=r[4],l=void 0,v=16;80>v;v++)l=e[v-3]^e[v-8]^e[v-14]^e[v-16],e[v]=l<<1|l>>>31;for(var c=0;20>c;c++)l=(o<<5|o>>>27)+f+e[c]+1518500249+(a&s|~a&u),f=u,u=s,s=a<<30|a>>>2,a=o,o=4294967295&l;for(var d=20;40>d;d++)l=(o<<5|o>>>27)+f+e[d]+1859775393+(a^s^u),f=u,u=s,s=a<<30|a>>>2,a=o,o=4294967295&l;for(var h=40;60>h;h++)l=(o<<5|o>>>27)+f+e[h]+2400959708+(a&s|a&u|s&u),f=u,u=s,s=a<<30|a>>>2,a=o,o=4294967295&l;for(var g=60;80>g;g++)l=(o<<5|o>>>27)+f+e[g]+3395469782+(a^s^u),f=u,u=s,s=a<<30|a>>>2,a=o,o=4294967295&l;return r[0]=r[0]+o&4294967295,r[1]=r[1]+a&4294967295,r[2]=r[2]+s&4294967295,r[3]=r[3]+u&4294967295,r[4]=r[4]+f&4294967295,r}for(var r=i(t(e,0),54),o=i(t(e,0),92),a="",s=0;a.length<64;){var u=[0,0,0,0,0];s++;for(var f=t(n,s),l=0;8192>l;l++){for(var v=1&l?o:r,c=v[0],d=v[1],h=v[2],g=v[3],E=v[4],R=void 0,p=16;80>p;p++)R=f[p-3]^f[p-8]^f[p-14]^f[p-16],f[p]=R<<1|R>>>31;for(var N=0;20>N;N++)R=(c<<5|c>>>27)+E+f[N]+1518500249+(d&h|~d&g),E=g,g=h,h=d<<30|d>>>2,d=c,c=4294967295&R;for(var S=20;40>S;S++)R=(c<<5|c>>>27)+E+f[S]+1859775393+(d^h^g),E=g,g=h,h=d<<30|d>>>2,d=c,c=4294967295&R;for(var _=40;60>_;_++)R=(c<<5|c>>>27)+E+f[_]+2400959708+(d&h|d&g|h&g),E=g,g=h,h=d<<30|d>>>2,d=c,c=4294967295&R;for(var W=60;80>W;W++)R=(c<<5|c>>>27)+E+f[W]+3395469782+(d^h^g),E=g,g=h,h=d<<30|d>>>2,d=c,c=4294967295&R;if(f[0]=v[0]+c&4294967295,f[1]=v[1]+d&4294967295,f[2]=v[2]+h&4294967295,f[3]=v[3]+g&4294967295,f[4]=v[4]+E&4294967295,1&l)u[0]^=f[0],u[1]^=f[1],u[2]^=f[2],u[3]^=f[3],u[4]^=f[4];else if(0===l){f[5]=2147483648;for(var w=6;15>w;w++)f[w]=0;f[15]=672}}for(var O=0;5>O;O++)for(var q=0;8>q;q++){var T=u[O]>>>28-4*q&15;a+=10>T?T:String.fromCharCode(87+T)}}return a.substring(0,64)}var n=function(e){return e&&e.__esModule?e["default"]:e},t=function(){function e(e,n){for(var t in n){var i=n[t];i.configurable=!0,i.value&&(i.writable=!0)}Object.defineProperties(e,n)}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),i=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},r=n(require("semver")),o=function(){function n(){i(this,n)}return t(n,{init:{value:function(e,n){this.httpInterface="http://"+e.host+":"+e.port,this.wifiInterface=this.httpInterface+"/wifi",this.loggingEnabled=!1,this.getVersion(function(e,t){if(e)return void n(e);var i=require("../package.json").platform,o=void 0;r.satisfies(t,i)||(o="Platform version check failed! Skill allows version "+i+" but your current version is "+t+"."),n(o)})}},setLogging:{value:function(e){this.loggingEnabled=e}},wifiStatus:{value:function(e){this._handleWifiRequest("STATUS-VERBOSE",e)}},addNetwork:{value:function(e){var n="ADD_NETWORK";this._handleWifiRequest(n,e)}},setNetwork:{value:function(n,t,i){var r=this,o=Object.keys(t);o.forEach(function(o){var a=void 0;"ssid"===o?(a='"'+t[o]+'"',r.ssid=t[o]):"password"===o&&t[o]?r.ssid?(a=e(t[o],r.ssid),o="psk"):i("No ssid to generate psk for WPA-PSK network"):a=t[o];var s="SET_NETWORK";s+=" "+n,s+=" "+o,s+=" "+a,r._handleWifiRequest(s,i)})}},removeNetwork:{value:function(e,n){this._handleWifiRequest("REMOVE_NETWORK "+e,n)}},saveConfig:{value:function(e){this._handleWifiRequest("SAVE_CONFIG",e)}},listNetworks:{value:function(e){this._handleWifiRequest("LIST_NETWORKS",e)}},reassociate:{value:function(e){this._handleWifiRequest("REASSOCIATE",e)}},reconfigure:{value:function(e){this._handleWifiRequest("RECONFIGURE",e)}},disconnect:{value:function(e){this._handleWifiRequest("DISCONNECT",e)}},reconnect:{value:function(e){this._handleWifiRequest("RECONNECT",e)}},disableNetwork:{value:function(e,n){this._handleWifiRequest("DISABLE_NETWORK "+e,n)}},enableNetwork:{value:function(e,n){this._handleWifiRequest("ENABLE_NETWORK "+e,n)}},selectNetwork:{value:function(e,n){this._handleWifiRequest("SELECT_NETWORK "+e,n)}},_handleWifiRequest:{value:function(e,n){var t=this,i={command:e},r=new XMLHttpRequest;i=JSON.stringify(i),r.open("POST",this.wifiInterface,!0),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=JSON.parse(r.response);t.loggingEnabled&&(console.log("response"),console.log(e.response)),e=e.response,n(null,e)}else 4==r.readyState&&0===r.status&&n("System Manager is unavailable")},this.loggingEnabled&&(console.log("body"),console.log(i)),r.send(i)}},getVersion:{value:function(e){this.getDisplayVersion(function(n,t){var i=t.trim().match("(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)");i?e(null,i[0]):e("No version found",null)})}},getDisplayVersion:{value:function(e){var n=this,t=new XMLHttpRequest;t.open("GET",this.httpInterface+"/version",!0),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var i=JSON.parse(t.response);n.loggingEnabled&&(console.log("version"),console.log(i.version));var r=i.version;e(null,r)}else 4==t.readyState&&0===t.status&&e("System Manager is unavailable",void 0)},t.send()}}}),n}(),a=new o;module.exports=a;